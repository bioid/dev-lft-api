language: node_js
node_js:
  - node
addons:
  apt:
    packages:
      - postgresql-12
      - postgresql-client-12
before_install:
  - sudo sed -i 's/port = 5433/port = 5432/' /etc/postgresql/12/main/postgresql.conf
  - sudo pg_ctlcluster 12 main restart
before_script:
  - psql -d $TEST_DB_URL -c 'create database "dev-lft-test";' -U postgres
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/001.do.create_users.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/002.do.create_projects_vacancies.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/003.do.create-requests.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/004.do.create-posts.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/005.do.create_chats_messages.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/006.do.create_notifications.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/007.do.alter_requests.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/008.do.remove_project_id.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/009.do.alter_chats.sql
  - psql -d $TEST_DB_URL -U postgres -f ./migrations/010.do.alter_projects.sql
